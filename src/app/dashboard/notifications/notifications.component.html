<div class="d-flex flex-column gap-20">
    <div class="form__card__head d-flex justify-content-md-between align-item-center">
        <h3>Notifications</h3>
        <div class="operation_button d-flex gap-10">
            <button class="btn-secondary d-flex align-item-center gap-10"
                [ngStyle]="{'display': notificationForm.disabled? 'none': 'flex'}" (click)="addNotification()">
                <span class="material-symbols-outlined">
                    add
                </span>
                <p> Add Notification</p>
            </button>
            
            <button class="btn-primary" [ngStyle]="{'display': notificationForm.disabled? 'none': 'flex'}"
                (click)="onUpdate()">Update</button>
        </div>
    </div>
    <form class="form__card d-flex gap-15 flex-column" [formGroup]="notificationForm">
        <ng-container formArrayName="notification">
            <ng-container *ngFor="let notification of getNotification(); let i = index">
                <div formGroupName="{{i}}" class=" d-flex gap-15 card card__pd-25 mw100 relative">
                    <button (click)="removeNotification(i)"
                        class="absolute btn-primary remove-banner-btn d-flex justify-content-center align-items-center"
                        *ngIf="i!=0">
                        <span class="material-symbols-outlined">
                            close
                        </span>
                    </button>
                    <div class="image-upload-div d-flex justify-content-center align-item-center relative">
                        <div class="upload-image d-flex flex-column gap-10 align-item-center">
                            <input type="file" [id]="'icon'+i" accept="image/jpg, image/jpeg, image/png"
                                (input)="notificationImageUpload($event, i)" />
                            <label [for]="'icon'+i"
                                class="upload__block d-flex flex-column flex-center pointer">
                                <span class="upload_icon material-symbols-outlined">
                                    cloud_upload
                                </span>
                            </label>
                            <small class="banner-label">Upload
                                Icon</small>
                            <img [src]="getImagePreview(i)" [style.display]="getImagePreview(i) ? 'flex' : 'none'"
                                class="banner-iage">
                            <span class="material-symbols-outlined remove-btn pointer"
                                [style.display]="getImagePreview(i) ? 'flex' : 'none'" (click)="removeImage(i)">
                                close
                            </span>
                            <div class="loader" *ngIf="showLoading(i)"></div>

                        </div>
                    </div>
                    <div class="data-upload-div d-flex gap-15">

                        <div class="d-flex flex-column mw100 gap-10">
                            <ng-container>
                                <div class="internal-div">
                                    <label class="form__title" for="title">Title</label>
                                    <input class="form__input" type="text" id="title" formControlName="title" />
                                </div>
                                <div class="internal-div">
                                    <label class="form__title" for="subTitle">SubTitle</label>
                                    <input class="form__input" type="text" id="body" formControlName="body" />
                                </div>
                                <!-- <div class="internal-div">
                                    <label class="form__title" for="icon">Icon</label>
                                    <input class="form__input" type="text" id="icon" formControlName="icon" />
                                </div> -->
                                <div class="internal-div">
                                    <label class="form__title" for="link">Link</label>
                                    <input class="form__input" type="text" id="url" formControlName="url" />
                                </div>
                            </ng-container>
                        </div>                
                    </div>
                </div>

                <div class="d-flex flex-column mw100 gap-10">
                    <ng-container formGroupName="registration_ids">
                      <div>
                        Total Subscribed User: {{ registrationIds.length }}
                      </div>
                      <!-- <select formControlName="yourFormControlName"> 
                        <option *ngFor="let registrationId of registrationIds; let i = index" [value]="registrationId">
                          {{ registrationId }}
                        </option>
                      </select> -->
                    </ng-container>
                  </div>
                  
            </ng-container>
        </ng-container>
    </form>
    <div class="d-flex" style="justify-content: flex-start;">
        <div class="table-list card">
            <table class="selected-category-table">
                <thead>
                    <tr>
                        <th class="items">Serial Number</th>
                        <th class="items">Title</th>
                        <th class="items">SubTitle</th>
                        <th class="items">icon</th>
                        <th class="items">Link</th>
                        <!-- <th class="items">Subcribed Users</th> -->
                        <th class="items">In-App Notification</th>
                        <th class="items">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of tableData; let i = index">
                        <td class="ellipsis items serial-number">1</td>
                        <td class="ellipsis items">{{item.notification.title}}</td>
                        <td class="ellipsis items">{{item.notification.body}}</td>
                        <td class="ellipsis items">{{item.notification.icon}}</td>
                        <td class="ellipsis items">{{item.notification.url}}</td>
                        <!-- <td class="ellipsis items">{{item.registration_ids}}</td> -->
                        <td class="items">
                            <div class="slide-button d-flex align-item-center">
                                <input type="checkbox" [checked]="item.state" (change)="toggle(item)"  [name]="i + 'Available'" [id]="i + 'Available'" />
                                <label [for]="i + 'Available'"></label>
                            </div>
                        </td>
                        <td class="items actions">
                            <div class="action-buttons">
                                <span class="material-symbols-outlined edit-button material-icons"  (click)="showItemDetails(item , i)">edit</span>
                                <span class="material-symbols-outlined delete-button material-icons" (click)="deleteItem(item)">delete</span>
                                <span class="material-symbols-outlined delete-button material-icons" (click)="sendNotification(item)">notifications</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>